<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Live Interest Earned</title>
  <style>
    body { font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial; margin: 24px; line-height: 1.35; }
    .card { max-width: 760px; padding: 18px; border: 1px solid #ddd; border-radius: 14px; }
    label { display:block; margin: 10px 0 6px; font-weight: 600; }
    input, select { width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 10px; font-size: 16px; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-top: 12px; }
    .big { font-size: 44px; font-weight: 900; margin: 10px 0 0; }
    .muted { color:#555; }
    .mono { font-variant-numeric: tabular-nums; }
    .row { margin-top: 14px; padding-top: 14px; border-top: 1px dashed #ddd; }
  </style>
</head>
<body>
  <div class="card">
    <h1 style="margin:0 0 6px;">Live Interest Earned</h1>
    <div class="muted">Interest only (principal not displayed). Updates every second.</div>

    <div class="grid">
      <div>
        <label>APR (%)</label>
        <input id="apr" type="number" step="0.0001" value="5">
      </div>
      <div>
        <label>Mode</label>
        <select id="mode">
          <option value="simple">Simple interest (linear)</option>
          <option value="continuous">Continuous compounding (smooth)</option>
        </select>
      </div>
    </div>

    <label style="margin-top:12px;">Start time (when accrual begins)</label>
    <input id="start" type="datetime-local">

    <label style="margin-top:12px;">Principal (hidden)</label>
    <input id="principal" type="password" inputmode="decimal" value="100000">

    <div class="row">
      <div class="muted">Interest accrued</div>
      <div id="interest" class="big mono">$0.0000</div>
      <div class="muted" style="margin-top:12px;">Elapsed time: <span id="elapsed" class="mono"></span></div>
    </div>
  </div>

<script>
(function () {
  var principalEl = document.getElementById('principal');
  var aprEl = document.getElementById('apr');
  var startEl = document.getElementById('start');
  var interestEl = document.getElementById('interest');
  var elapsedEl = document.getElementById('elapsed');
  var modeEl = document.getElementById('mode');

  function pad(n){ return String(n).padStart(2,'0'); }

  // Set default start = now (local)
  var now = new Date();
  var local = new Date(now.getTime() - now.getTimezoneOffset()*60000);
  startEl.value = local.getFullYear() + '-' + pad(local.getMonth()+1) + '-' + pad(local.getDate()) +
                  'T' + pad(local.getHours()) + ':' + pad(local.getMinutes());

  var fmt = new Intl.NumberFormat(undefined, {
    style: 'currency',
    currency: 'USD',
    minimumFractionDigits: 4,
    maximumFractionDigits: 6
  });

  var SECONDS_PER_YEAR = 365.2425 * 24 * 60 * 60;

  function calc(){
    var P = Math.max(0, Number(principalEl.value || 0));
    var r = Math.max(0, Number(aprEl.value || 0)) / 100;

    var start = new Date(startEl.value);
    var tSeconds = Math.max(0, (Date.now() - start.getTime()) / 1000);
    var tYears = tSeconds / SECONDS_PER_YEAR;

    var total;
    if (modeEl.value === 'continuous') total = P * Math.exp(r * tYears);
    else total = P * (1 + r * tYears);

    var interest = total - P;
    interestEl.textContent = fmt.format(interest);

    var hrs = Math.floor(tSeconds / 3600);
    var mins = Math.floor((tSeconds % 3600) / 60);
    var secs = Math.floor(tSeconds % 60);
    elapsedEl.textContent = hrs + 'h ' + mins + 'm ' + secs + 's';
  }

  setInterval(calc, 1000);
  calc();
})();
</script>
</body>
</html>
